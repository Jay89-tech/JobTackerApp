@model List<SkillsManagement.Controllers.NotificationTemplate>
@{
    ViewData["Title"] = "Notification Templates";
}

@section Styles {
    <link rel="stylesheet" href="~/css/template.css" />
}

<div class="page-header mb-4">
    <div>
        <a asp-action="Index" class="btn btn-outline-secondary mb-2">
            <i class="fas fa-arrow-left"></i> Back
        </a>
        <h2>Notification Templates</h2>
        <p class="text-muted">Pre-defined templates for common notification scenarios</p>
    </div>
    <div>
        <a asp-action="Send" class="btn btn-primary">
            <i class="fas fa-paper-plane"></i> Send Custom Notification
        </a>
    </div>
</div>

<!-- Templates Grid -->
<div class="row">
    @foreach (var template in Model)
    {
        <div class="col-md-6 col-lg-4 mb-4">
            <div class="template-card">
                <div class="template-header">
                    <div class="template-icon @GetIconClass(template.Type)">
                        <i class="fas @GetIconName(template.Type)"></i>
                    </div>
                    <div class="template-info">
                        <h5>@template.Name</h5>
                        <span class="template-type-badge badge @GetBadgeClass(template.Type)">
                            @template.Type
                        </span>
                    </div>
                </div>

                <div class="template-body">
                    <div class="template-preview">
                        <div class="preview-label">Title:</div>
                        <div class="preview-content">@template.Title</div>

                        <div class="preview-label mt-3">Message:</div>
                        <div class="preview-content">@template.Message</div>
                    </div>
                </div>

                <div class="template-footer">
                    <button type="button"
                            class="btn btn-primary w-100"
                            onclick="useTemplate('@template.Title', '@template.Message', '@template.Type')">
                        <i class="fas fa-arrow-right"></i> Use This Template
                    </button>
                </div>
            </div>
        </div>
    }
</div>

<!-- Template Usage Info -->
<div class="card mt-4">
    <div class="card-header">
        <h5><i class="fas fa-info-circle"></i> About Notification Templates</h5>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-4">
                <div class="info-box">
                    <i class="fas fa-lightbulb text-warning fa-2x mb-3"></i>
                    <h6>Time-Saving</h6>
                    <p>Pre-written templates help you send notifications quickly without typing the same messages repeatedly.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="info-box">
                    <i class="fas fa-check-circle text-success fa-2x mb-3"></i>
                    <h6>Consistent Messaging</h6>
                    <p>Ensure all employees receive consistent, professional communications across the organization.</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="info-box">
                    <i class="fas fa-edit text-info fa-2x mb-3"></i>
                    <h6>Customizable</h6>
                    <p>Templates can be modified before sending to personalize the message for specific situations.</p>
                </div>
            </div>
        </div>

        <div class="alert alert-info mt-4 mb-0">
            <strong><i class="fas fa-question-circle"></i> How to use:</strong>
            Click "Use This Template" on any template card. You'll be redirected to the send notification page with the template pre-filled, where you can customize it and select recipients.
        </div>
    </div>
</div>

<!-- Template Categories Info -->
<div class="row mt-4">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-tags"></i> Notification Types</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <div class="type-explanation">
                            <span class="badge bg-danger mb-2">
                                <i class="fas fa-exclamation-circle"></i> Alert
                            </span>
                            <p>Important system messages that require immediate attention. Used for critical updates, warnings, or urgent information.</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="type-explanation">
                            <span class="badge bg-info mb-2">
                                <i class="fas fa-info-circle"></i> Update
                            </span>
                            <p>General information and system updates. Used for profile changes, policy updates, or general announcements.</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="type-explanation">
                            <span class="badge bg-warning mb-2">
                                <i class="fas fa-lightbulb"></i> Suggestion
                            </span>
                            <p>Recommendations and opportunities. Used for training suggestions, skill development tips, or helpful resources.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        function useTemplate(title, message, type) {
            // Encode the parameters to safely pass them in URL
            const params = new URLSearchParams({
                title: title,
                message: message,
                type: type
            });

            // Redirect to Send page with template data
            window.location.href = '@Url.Action("Send", "Notifications")?' + params.toString();
        }
    </script>
}

@functions {
    private string GetIconClass(string type)
    {
        return type switch
        {
            "Alert" => "icon-alert",
            "Update" => "icon-update",
            "Suggestion" => "icon-suggestion",
            _ => "icon-update"
        };
    }

    private string GetIconName(string type)
    {
        return type switch
        {
            "Alert" => "fa-exclamation-circle",
            "Update" => "fa-info-circle",
            "Suggestion" => "fa-lightbulb",
            _ => "fa-bell"
        };
    }

    private string GetBadgeClass(string type)
    {
        return type switch
        {
            "Alert" => "bg-danger",
            "Update" => "bg-info",
            "Suggestion" => "bg-warning",
            _ => "bg-secondary"
        };
    }
}