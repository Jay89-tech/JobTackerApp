@{
    ViewData["Title"] = "Reports & Analytics";
}

@section Styles {
    <link rel="stylesheet" href="~/css/report.css" />
}

<div class="page-header mb-4">
    <div>
        <h2>Reports & Analytics</h2>
        <p class="text-muted">Generate comprehensive reports and insights</p>
    </div>
</div>

<div class="row">
    <!-- Skill Audit Report -->
    <div class="col-md-6 mb-4">
        <div class="report-card">
            <div class="report-icon">
                <i class="fas fa-chart-bar"></i>
            </div>
            <div class="report-content">
                <h4>Skills Audit Report</h4>
                <p>Comprehensive overview of all employee skills, proficiency levels, and skill gaps across the organization.</p>
                <div class="report-features">
                    <span><i class="fas fa-check"></i> Employee skills breakdown</span>
                    <span><i class="fas fa-check"></i> Proficiency analysis</span>
                    <span><i class="fas fa-check"></i> Exportable to Excel/PDF</span>
                </div>
            </div>
            <div class="report-actions">
                <a asp-action="SkillAudit" class="btn btn-primary mb-2">
                    <i class="fas fa-eye"></i> View Report
                </a>
                <div class="btn-group w-100">
                    <a asp-action="ExportSkillAuditExcel" class="btn btn-success">
                        <i class="fas fa-file-excel"></i> Excel
                    </a>
                    <a asp-action="ExportSkillAuditPDF" class="btn btn-danger">
                        <i class="fas fa-file-pdf"></i> PDF
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Training Summary -->
    <div class="col-md-6 mb-4">
        <div class="report-card">
            <div class="report-icon">
                <i class="fas fa-graduation-cap"></i>
            </div>
            <div class="report-content">
                <h4>Training Summary Report</h4>
                <p>Detailed analysis of training programs, completion rates, and employee participation across all departments.</p>
                <div class="report-features">
                    <span><i class="fas fa-check"></i> Completion statistics</span>
                    <span><i class="fas fa-check"></i> HR suggested vs self-enrolled</span>
                    <span><i class="fas fa-check"></i> Department breakdown</span>
                </div>
            </div>
            <div class="report-actions">
                <a asp-action="TrainingSummary" class="btn btn-primary mb-2">
                    <i class="fas fa-eye"></i> View Report
                </a>
                <div class="btn-group w-100">
                    <a asp-action="ExportTrainingSummaryExcel" class="btn btn-success">
                        <i class="fas fa-file-excel"></i> Excel
                    </a>
                    <a asp-action="ExportTrainingSummaryPDF" class="btn btn-danger">
                        <i class="fas fa-file-pdf"></i> PDF
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Department Analysis -->
    <div class="col-md-6 mb-4">
        <div class="report-card">
            <div class="report-icon">
                <i class="fas fa-building"></i>
            </div>
            <div class="report-content">
                <h4>Department Analysis</h4>
                <p>Compare skills, qualifications, and training metrics across different departments in your organization.</p>
                <div class="report-features">
                    <span><i class="fas fa-check"></i> Department comparison</span>
                    <span><i class="fas fa-check"></i> Skill distribution</span>
                    <span><i class="fas fa-check"></i> Performance metrics</span>
                </div>
            </div>
            <div class="report-actions">
                <a asp-action="DepartmentAnalysis" class="btn btn-primary mb-2">
                    <i class="fas fa-eye"></i> View Report
                </a>
                <div class="btn-group w-100">
                    <a asp-action="ExportDepartmentAnalysisExcel" class="btn btn-success">
                        <i class="fas fa-file-excel"></i> Excel
                    </a>
                    <a asp-action="ExportDepartmentAnalysisPDF" class="btn btn-danger">
                        <i class="fas fa-file-pdf"></i> PDF
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom Reports (Coming Soon) -->
    <div class="col-md-6 mb-4">
        <div class="report-card report-card-disabled">
            <div class="report-icon">
                <i class="fas fa-magic"></i>
            </div>
            <div class="report-content">
                <h4>Custom Report Builder</h4>
                <p>Create customized reports with specific metrics, filters, and visualizations tailored to your needs.</p>
                <div class="report-features">
                    <span><i class="fas fa-check"></i> Custom filters</span>
                    <span><i class="fas fa-check"></i> Multiple export formats</span>
                    <span><i class="fas fa-check"></i> Save report templates</span>
                </div>
                <span class="badge bg-info">Coming Soon</span>
            </div>
            <div class="report-actions">
                <button class="btn btn-secondary w-100" disabled>
                    <i class="fas fa-lock"></i> Coming Soon
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Quick Export Section -->
<div class="card mt-4">
    <div class="card-header">
        <h5><i class="fas fa-download"></i> Quick Export Options</h5>
    </div>
    <div class="card-body">
        <p class="text-muted mb-3">Generate and download reports instantly in your preferred format</p>
        <div class="export-buttons">
            <a asp-action="ExportSkillAuditExcel" class="export-btn">
                <i class="fas fa-file-excel"></i>
                <span>Skills Audit (Excel)</span>
            </a>
            <a asp-action="ExportTrainingSummaryExcel" class="export-btn">
                <i class="fas fa-file-excel"></i>
                <span>Training Summary (Excel)</span>
            </a>
            <a asp-action="ExportDepartmentAnalysisExcel" class="export-btn">
                <i class="fas fa-file-excel"></i>
                <span>Department Analysis (Excel)</span>
            </a>
        </div>
        <div class="alert alert-info mt-3">
            <i class="fas fa-info-circle"></i>
            <strong>PDF Export:</strong> To export any report as PDF, view the report and use your browser's print function (Ctrl+P or Cmd+P), then select "Save as PDF" as the destination.
        </div>
    </div>
</div>